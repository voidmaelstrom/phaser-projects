<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Pinball</title>
		<meta property="og:title" content="Pinball"/>
		<meta property="og:url" content="Pinball.htm"/>
		<meta property="og:description" content=""/>
		<meta property="og:image" content="PinballShare.png"/>
		<meta property="og:type" content="website"/>
		<meta property="og:site_name" content="Pinball"/>
		<meta name="theme-color" content="#000000"/>
		<meta name="mobile-web-app-capable" content="yes"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<link rel="manifest" href="Pinball.json"/>
		<link rel="icon" sizes="16x16" type="image/png" href="PinballFavIcon_16x16.png"/>
		<link rel="icon" sizes="192x192" type="image/png" href="PinballFavIcon_192x192.png"/>
		<link rel="apple-touch-icon" type="image/png" href="assets/pinballfavicon.png"/>
		<link rel="apple-touch-startup-image" type="image/png" href="assets/pinballfavicon.png">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
		<style>
			html,body{background-color:black;height:100%;padding:0;margin:0;overflow:hidden}
			#content{position:fixed;height:100%;width:100%;margin:0;padding:0;border:none;display:none}
		</style>
	</head>
	<body>
		<iframe id="content" src="about:blank"></iframe>
		<script>

			// Workaround for audio in Safari
			var finalAudioContext = null;
			window.AudioContext = window.AudioContext || window.webkitAudioContext;
			function fixAudioContext(e){if(finalAudioContext==null){finalAudioContext=new AudioContext();finalAudioContext.resume();}}
			document.addEventListener("click",fixAudioContext);
			document.addEventListener("touchstart",fixAudioContext);

			function resizeContent()
				{
				document.getElementById("content").style.width = window.innerWidth + "px";
				document.getElementById("content").style.height = window.innerHeight + "px";
				}

			window.addEventListener("load", function()
				{
				// Seeing if the game is not running in an iframe
				if (window.top == window.self)
					{
					// Resize the iframe
					resizeContent();

					// Workaround for IOS devices to keep resizing and focusing the iframe
					setInterval(function()
						{
						resizeContent();
						document.getElementById("content").focus();
						}, 250);

					// Load the game
					document.getElementById("content").src = "PinballGame.html";

					// Show the iframe
					document.getElementById("content").style.display = "block";
					}
				});

			window.addEventListener("resize", function()
				{
				// Resize iframe when the screen changes
				resizeContent();
				});

			var supportsOrientationChange = "onorientationchange" in window, orientationEvent = supportsOrientationChange ? "orientationchange" : "resize";
			window.addEventListener(orientationEvent, function()
				{
				// Resize the iframe as the screen orientation shifts
				resizeContent();
				}, false);

			if ("serviceWorker" in navigator)
				{
				navigator.serviceWorker.register("worker.js").then(function(registration)
					{
					// Registration successful
					//console.log("ServiceWorker registration successful with scope: " + registration.scope);
					}).catch(function(err)
					{
					// Registration failed
					//console.log("ServiceWorker registration failed: " + err);
					});
				}
		</script>
	</body>
</html>